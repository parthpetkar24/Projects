{% extends 'base.html' %}
{% load static %}

{% block title %}Hospital Dashboard {% endblock %}
{% block sub_head %}
    <link rel="stylesheet" href="{% static 'hospital_dashboard.css' %}">
{% endblock %}

{% block hero %}
<!-- HERO -->
<section class="hero text-center">
  <h1>{{ user.hospitalprofile.hospital_name }} Dashboard</h1>
  <p>Saving Lives</p>
</section>
{% endblock %}

{% block body %}
<form action="/hospital_dashboard/" method="post">
{% csrf_token %}
<table class="table mt-3 text-center align-middle">
  <thead>
    <tr>
      <th>Blood Group</th>
      <th>Units</th>
      <th>+</th>
      <th>-</th>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td>A+</td>
      <td id="aplus_display">{{user.hospitalprofile.aplusunit}}</td>
      <input type="hidden" name="aplusunit"  id="aplus_store" value="{{ user.hospitalprofile.aplusunit }}">

      <td>
        <button  type="button" class="btn btn-sm btn-outline-success" onclick="increaseUnit('aplus')">
          +
        </button>
      </td>
      <td>
        <button type="button" class="btn btn-sm btn-outline-danger" onclick="decreaseUnit('aplus')">
          -
        </button>
      </td>
    </tr>
        <tr>
      <td>A-</td>
      <td id="aminus_display">{{user.hospitalprofile.aminusunit}}</td>
      <input type="hidden" name="aminusunit"  id="aminus_store" value="{{ user.hospitalprofile.aminusunit }}">

      <td>
        <button  type="button" class="btn btn-sm btn-outline-success" onclick="increaseUnit('aminus')">
          +
        </button>
      </td>
      <td>
        <button type="button" class="btn btn-sm btn-outline-danger" onclick="decreaseUnit('aminus')">
          -
        </button>
      </td>
    </tr>
        <tr>
      <td>B+</td>
      <td id="bplus_display">{{user.hospitalprofile.bplusunit}}</td>
      <input type="hidden" name="bplusunit"  id="bplus_store" value="{{ user.hospitalprofile.bplusunit }}">

      <td>
        <button  type="button" class="btn btn-sm btn-outline-success" onclick="increaseUnit('bplus')">
          +
        </button>
      </td>
      <td>
        <button type="button" class="btn btn-sm btn-outline-danger" onclick="decreaseUnit('bplus')">
          -
        </button>
      </td>
    </tr>
        <tr>
      <td>B-</td>
      <td id="bminus_display">{{user.hospitalprofile.bminusunit}}</td>
      <input type="hidden" name="bminusunit"  id="bminus_store" value="{{ user.hospitalprofile.bminusunit }}">

      <td>
        <button  type="button" class="btn btn-sm btn-outline-success" onclick="increaseUnit('bminus')">
          +
        </button>
      </td>
      <td>
        <button type="button" class="btn btn-sm btn-outline-danger" onclick="decreaseUnit('bminus')">
          -
        </button>
      </td>
    </tr>
        <tr>
      <td>AB+</td>
      <td id="abplus_display">{{user.hospitalprofile.abplusunit}}</td>
      <input type="hidden" name="abplusunit"  id="abplus_store" value="{{ user.hospitalprofile.abplusunit }}">

      <td>
        <button  type="button" class="btn btn-sm btn-outline-success" onclick="increaseUnit('abplus')">
          +
        </button>
      </td>
      <td>
        <button type="button" class="btn btn-sm btn-outline-danger" onclick="decreaseUnit('abplus')">
          -
        </button>
      </td>
    </tr>
    <tr>
      <td>AB-</td>
      <td id="abminus_display">{{user.hospitalprofile.abminusunit}}</td>
      <input type="hidden" name="abminusunit"  id="abminus_store" value="{{ user.hospitalprofile.abminusunit }}">

      <td>
        <button  type="button" class="btn btn-sm btn-outline-success" onclick="increaseUnit('abminus')">
          +
        </button>
      </td>
      <td>
        <button type="button" class="btn btn-sm btn-outline-danger" onclick="decreaseUnit('abminus')">
          -
        </button>
      </td>
    </tr><tr>
      <td>O+</td>
      <td id="oplus_display">{{user.hospitalprofile.oplusunit}}</td>
      <input type="hidden" name="oplusunit"  id="oplus_store" value="{{ user.hospitalprofile.oplusunit }}">

      <td>
        <button  type="button" class="btn btn-sm btn-outline-success" onclick="increaseUnit('oplus')">
          +
        </button>
      </td>
      <td>
        <button type="button" class="btn btn-sm btn-outline-danger" onclick="decreaseUnit('oplus')">
          -
        </button>
      </td>
    </tr><tr>
      <td>O-</td>
      <td id="ominus_display">{{user.hospitalprofile.ominusunit}}</td>
      <input type="hidden" name="ominusunit"  id="ominus_store" value="{{ user.hospitalprofile.ominusunit }}">

      <td>
        <button  type="button" class="btn btn-sm btn-outline-success" onclick="increaseUnit('ominus')">
          +
        </button>
      </td>
      <td>
        <button type="button" class="btn btn-sm btn-outline-danger" onclick="decreaseUnit('ominus')">
          -
        </button>
      </td>
    </tr>
  </tbody>
</table>
<div class="text-center">
  <button type="submit" class="btn btn-danger mt-3">
    Save 
  </button>
</div>
</form>

<div class="row g-4 mt-2">

 <div class="col-md-6">
    <div class="card dashboard-card">
      <h5><i class="bi bi-heart-fill"></i> Blood Donation Applications</h5>
      <div class="application-scroll-container">
        {% for item in blood_donations %}
        <div class="application-card">
          <p><strong>Form ID:</strong> {{ item.form_id }}</p>
          <p><strong>Donor:</strong> {{ item.name }}</p>
          <p><strong>Blood Group:</strong> {{ item.data.blood_group }}</p>
          <p><strong>City:</strong> {{ item.city }}</p>
          <p><strong>Phone:</strong> {{ item.phone }}</p>
          <p><strong>Distance:</strong> {{ item.distance }} km</p>
          <p><strong>Weight:</strong> {{ item.data.weight }} kg</p>
          <p><strong>Gender:</strong> {{ item.data.get_gender_display }}</p>
          <p><strong>DOB:</strong> {{ item.data.dob }}</p>
          {% if item.data.medical_condition %}
          <p><strong>Medical Condition:</strong> {{ item.data.medical_condition }}</p>
          {% endif %}
          <button class="btn btn-success btn-sm">Approve</button>
          <button class="btn btn-outline-danger btn-sm">Reject</button>
        </div>
        {% empty %}
        <p class="text-muted">No nearby blood donations</p>
        {% endfor %}
      </div>
    </div>
  </div>

  <!-- BLOOD REQUEST -->
  <div class="col-md-6">
    <div class="card dashboard-card highlight-card">
      <h5><i class="bi bi-droplet-half"></i> Blood Request Applications</h5>
      <div class="application-scroll-container">
        {% for item in blood_requests %}
        <div class="application-card">
          <p><strong>Form ID:</strong> {{ item.form_id }}</p>
          <p><strong>Patient:</strong> {{ item.name }}</p>
          <p><strong>Blood Group:</strong> {{ item.data.blood_group }}</p>
          <p><strong>City:</strong> {{ item.city }}</p>
          <p><strong>Phone:</strong> {{ item.phone }}</p>
          <p><strong>Distance:</strong> {{ item.distance }} km</p>
          <p><strong>Weight:</strong> {{ item.data.weight }} kg</p>
          <p><strong>Gender:</strong> {{ item.data.get_gender_display }}</p>
          <p><strong>DOB:</strong> {{ item.data.dob }}</p>
          {% if item.data.medical_condition %}
          <p><strong>Medical Condition:</strong> {{ item.data.medical_condition }}</p>
          {% endif %}
          <button class="btn btn-success btn-sm">Approve</button>
          <button class="btn btn-outline-danger btn-sm">Reject</button>
        </div>
        {% empty %}
        <p class="text-muted">No nearby blood requests</p>
        {% endfor %}
      </div>
    </div>
  </div>

  <!-- ORGAN DONATION -->
  <div class="col-md-6">
    <div class="card dashboard-card">
      <h5><i class="bi bi-lungs-fill"></i> Organ Donation Applications</h5>
      <div class="application-scroll-container">
        {% for item in organ_donations %}
        <div class="application-card">
          <p><strong>Form ID:</strong> {{ item.form_id }}</p>
          <p><strong>Donor:</strong> {{ item.name }}</p>
          <p><strong>Organ:</strong> {{ item.data.organ }}</p>
          <p><strong>Status:</strong> {{ item.data.get_aliveordec_display }}</p>
          <p><strong>City:</strong> {{ item.city }}</p>
          <p><strong>Phone:</strong> {{ item.phone }}</p>
          <p><strong>Distance:</strong> {{ item.distance }} km</p>
          <p><strong>Weight:</strong> {{ item.data.weight }} kg</p>
          <p><strong>Gender:</strong> {{ item.data.get_gender_display }}</p>
          <p><strong>DOB:</strong> {{ item.data.dob }}</p>
          <p><strong>Medical Condition:</strong> {{ item.data.medical_condition }}</p>
          <button class="btn btn-success btn-sm">Approve</button>
          <button class="btn btn-outline-danger btn-sm">Reject</button>
        </div>
        {% empty %}
        <p class="text-muted">No nearby organ donations</p>
        {% endfor %}
      </div>
    </div>
  </div>

  <!-- ORGAN REQUEST -->
  <div class="col-md-6">
    <div class="card dashboard-card highlight-card">
      <h5><i class="bi bi-hospital-fill"></i> Organ Request Applications</h5>
      <div class="application-scroll-container">
        {% for item in organ_requests %}
        <div class="application-card">
          <p><strong>Form ID:</strong> {{ item.form_id }}</p>
          <p><strong>Patient:</strong> {{ item.name }}</p>
          <p><strong>Organ Needed:</strong> {{ item.data.organ }}</p>
          <p><strong>City:</strong> {{ item.city }}</p>
          <p><strong>Phone:</strong> {{ item.phone }}</p>
          <p><strong>Distance:</strong> {{ item.distance }} km</p>
          <p><strong>Weight:</strong> {{ item.data.weight }} kg</p>
          <p><strong>Gender:</strong> {{ item.data.get_gender_display }}</p>
          <p><strong>DOB:</strong> {{ item.data.dob }}</p>
          <p><strong>Medical Condition:</strong> {{ item.data.medical_condition }}</p>
          <button class="btn btn-success btn-sm">Approve</button>
          <button class="btn btn-outline-danger btn-sm">Reject</button>
        </div>
        {% empty %}
        <p class="text-muted">No nearby organ requests</p>
        {% endfor %}
      </div>
    </div>
  </div>

  <!-- EMERGENCY BLOOD REQUEST -->
  <div class="col-md-6">
    <div class="card dashboard-card highlight-card">
      <h5><i class="bi bi-exclamation-triangle-fill"></i> Emergency Blood Request Applications</h5>
      <div class="application-scroll-container">
        {% for item in emergency_blood_requests %}
        <div class="application-card">
          <p><strong>Form ID:</strong> {{ item.form_id }}</p>
          <p><strong>Patient:</strong> {{ item.name }}</p>
          <p><strong>Blood Group:</strong> {{ item.data.blood_group }}</p>
          <p><strong>City:</strong> {{ item.city }}</p>
          <p><strong>Phone:</strong> {{ item.phone }}</p>
          <p><strong>Distance:</strong> {{ item.distance }} km</p>
          <p><strong>Weight:</strong> {{ item.data.weight }} kg</p>
          <p><strong>Gender:</strong> {{ item.data.get_gender_display }}</p>
          <p><strong>DOB:</strong> {{ item.data.dob }}</p>
          {% if item.data.medical_condition %}
          <p><strong>Medical Condition:</strong> {{ item.data.medical_condition }}</p>
          {% endif %}
          <button class="btn btn-success btn-sm">Approve</button>
          <button class="btn btn-outline-danger btn-sm">Reject</button>
        </div>
        {% empty %}
        <p class="text-muted">No nearby emergency blood requests</p>
        {% endfor %}
      </div>
    </div>
  </div>

  <!-- EMERGENCY ORGAN REQUEST -->
  <div class="col-md-6">
    <div class="card dashboard-card highlight-card">
      <h5><i class="bi bi-exclamation-triangle-fill"></i> Emergency Organ Request Applications</h5>
      <div class="application-scroll-container">
        {% for item in emergency_organ_requests %}
        <div class="application-card">
          <p><strong>Form ID:</strong> {{ item.form_id }}</p>
          <p><strong>Patient:</strong> {{ item.name }}</p>
          <p><strong>Organ Needed:</strong> {{ item.data.organ }}</p>
          <p><strong>City:</strong> {{ item.city }}</p>
          <p><strong>Phone:</strong> {{ item.phone }}</p>
          <p><strong>Distance:</strong> {{ item.distance }} km</p>
          <p><strong>Weight:</strong> {{ item.data.weight }} kg</p>
          <p><strong>Gender:</strong> {{ item.data.get_gender_display }}</p>
          <p><strong>DOB:</strong> {{ item.data.dob }}</p>
          <p><strong>Medical Condition:</strong> {{ item.data.medical_condition }}</p>
          <button class="btn btn-success btn-sm">Approve</button>
          <button class="btn btn-outline-danger btn-sm">Reject</button>
        </div>
        {% empty %}
        <p class="text-muted">No nearby emergency organ requests</p>
        {% endfor %}
      </div>
    </div>
  </div>

</div>



  <!-- NEWS SECTION -->
  <div class="card dashboard-card mt-5">
    <h5><i class="bi bi-megaphone"></i> Publish Hospital News</h5>

    <input type="text" class="form-control mb-2" placeholder="News Title">
    <textarea class="form-control mb-3" rows="3" placeholder="News Message"></textarea>

    <button class="btn btn-danger">Publish News</button>

    <hr>

    <ul class="list-group list-group-flush">
      <li class="list-group-item">ü©∏ O+ Blood urgently needed</li>
      <li class="list-group-item">üè• Donation camp on Sunday</li>
    </ul>
  </div>

</div>

<script src="{% static 'hospital_dashboard.js' %}"></script>
{% endblock %}
