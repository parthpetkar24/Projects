{% extends 'base.html' %}
{% load static %}

{% block title %}Donate{% endblock %}

{% block sub_head %}
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
<link href="{% static 'donate.css' %}" rel="stylesheet">
{% endblock %}

{% block hero %}
<section class="hero">
  <h1>Be Someone's Hero</h1>
  <p class="mb-0">Complete the steps to register as a donor</p>
</section>
{% endblock %}

{% block body %}
<div class="container col-lg-7 col-md-9 mt-n5">
  <div class="card-glass p-4">

    <!-- STEP INDICATOR -->
    <div class="step-indicator d-flex justify-content-center gap-3 mb-4">
      <span id="s1" class="active">1</span>
      <span id="s2">2</span>
      <span id="s3">3</span>
      <span id="s4">4</span>
    </div>

    <!-- ONE FORM ONLY -->
    <form method="post" action="/donate/" enctype="multipart/form-data">
      {% csrf_token %}

      <!-- STEP 1 -->
      <div id="step1">
        <h4 class="fw-bold text-center mb-3">Choose Donation Type</h4>

        <input type="hidden" name="donation_type" id="donationType" value="blood">

        <div class="d-grid d-md-flex gap-3 justify-content-center">
          <button type="button"
                  class="btn btn-outline-danger donate-btn tab-btn active"
                  onclick="selectType('blood', this)">
            Blood
          </button>

          <button type="button"
                  class="btn btn-outline-danger donate-btn tab-btn"
                  onclick="selectType('organ', this)">
            Organ
          </button>
        </div>

        <div class="text-center mt-4">
          <button type="button"
                  class="btn btn-success donate-btn px-5"
                  onclick="nextStep(2)">
            Next
          </button>
        </div>
      </div>

      <!-- STEP 2 -->
      <div id="step2" class="hidden">
        <h4 class="fw-bold mb-3">Your Details</h4>

        <div class="row g-3">
          <input type="text" class="form-control" name="full_name" placeholder="Full Name" required>
          <input type="text" class="form-control" name="aadhar_id" placeholder="Aadhar ID" maxlength="12" required>
          <input type="date" class="form-control" name="dob" id="dob" onchange="calculateAge()" required>

          <input type="number" class="form-control" name="age" id="age" placeholder="Age" readonly>

          <select name="gender" class="form-select" required>
            <option value="">Gender</option>
            <option value="M">Male</option>
            <option value="F">Female</option>
            <option value="O">Other</option>
            <option value="PNS">Prefer Not Say</option>
          </select>

          <input type="text" class="form-control" name="city" placeholder="City" required>
          <input type="tel" class="form-control" name="phone" placeholder="Phone" required>
        </div>

        <div class="d-flex justify-content-between mt-4">
          <button type="button" class="btn btn-outline-secondary donate-btn" onclick="nextStep(1)">Back</button>
          <button type="button" class="btn btn-success donate-btn" onclick="nextStep(3)" >Next</button>
        </div>
      </div>

      <!-- STEP 3 -->
      <div id="step3" class="hidden">
        <h4 class="fw-bold mb-3">Physical Details</h4>

        <!-- BLOOD -->
        <div id="bloodSection">
          <select name="blood_group" class="form-select">
            <option value="">Blood Group</option>
            <option>AB+</option>
            <option>AB-</option>
            <option>A+</option>
            <option>A-</option>
            <option>B+</option>
            <option>B-</option>
            <option>O+</option>
            <option>O-</option>
          </select>
        </div>

        <!-- ORGAN -->
        <div id="organSection" class="hidden">
          <select name="aliveordec" class="form-select mb-3">
            <option value="">Donor Alive or Deceased?</option>
            <option value="A">Alive</option>
            <option value="D">Deceased</option>
          </select>

          <select name="organ" class="form-select mb-3">
            <option value="">Organ</option>
            <option>Kidney</option>
            <option>Liver</option>
            <option>Lungs</option>
            <option>Heart</option>
            <option>Pancreas</option>
            <option>Intestine</option>
            <option>Uterus</option>
            <option>Eyes</option>
            <option>Tissues</option>
          </select>
        </div>

        <input type="number" class="form-control mb-3 mt-2" name="weight" placeholder="Weight (in kg)" required>
        <input type="text" class="form-control mb-3" name="medical_condition" placeholder="Any Prior Medical or Physical Condition (if any)">

        <label class="form-label">Upload Doctor Report</label>
        <input type="file" class="form-control mb-3" name="doc_report" required>

        <div class="d-flex justify-content-between mt-4">
          <button type="button" class="btn btn-outline-secondary donate-btn"
                  onclick="nextStep(2)">Back</button>

          <button type="button" class="btn btn-success donate-btn"
                  onclick="nextStep(4)">Next</button>
        </div>
      </div>

      <!-- STEP 4 -->
      <div id="step4" class="hidden text-center">
        <i class="bi bi-heart-fill text-danger fs-1"></i>
        <h4 class="fw-bold mt-2">Confirm & Submit</h4>

        <div class="form-check d-flex align-items-center justify-content-center mt-3">
  <input class="form-check-input me-2 consent-check"
         type="checkbox"
         id="consent"
         name="consent"
         required>
  <label class="form-check-label" for="consent">
    I voluntarily consent to donate blood/organs
  </label>
</div>

<!-- Buttons -->
<div class="d-flex justify-content-between align-items-center mt-4">
  <button type="button"
          class="btn btn-outline-secondary donate-btn"
          onclick="nextStep(3)">
    Back
  </button>

  <button type="submit"
          class="btn btn-success donate-btn px-5">
    Submit
  </button>
</div>
        
      </div>

    </form>
  </div>
</div>

<script src="{% static 'donate.js' %}"></script>
{% endblock %}
